# Linux基础
## 基础篇
### VM和Linux安装
- VMware下载：https://www.vmware.com/cn.html
- Centos7.6/8.1下载：https://archive.kernel.org/centos-vault/
- 新建虚拟机
  - CPU分配：根据本机资源酌情分配核心
  - 网络连接模式
    - NAT模式（建议）：网络地址转换模式，可以和外部通讯，不造成IP冲突
    - 桥接模式：虚拟系统可以和外部系统通讯，但容易造成IP冲突
    - 仅主机模式：独立系统，不与外部通讯 
  - 软件选择（默认最小安装，方便选择：GNOME桌面，传统X Windows兼容性、兼容性程序库、开发工具）
  - 分区设置
    - boot 标准分区 ext4 1G
    - swap 标准分区 swap 2G（和分配内存大小一致即可）
    - / 标准分区 ext4 17G
  - KDUMP：内核崩溃转储机制，生产环境建议开启
  - 网络：打开以太网，修改主机名
  - 设置密码和用户（生产环境中建议[生成复杂密码](https://suijimimashengcheng.bmcx.com/)）
  - 安装VMtool 
- 虚拟机操作
 - 虚拟机克隆
    - 直接复制文件夹
    - 使用VMware克隆
  - 快照
  - 迁移和删除
    - 直接剪切文件夹可以迁移
    - 直接删除文件夹可以删除
### Linux目录结构
- 树状结构
  - /：根目录
  - /bin：常用指令
  - /sbin：管理员指令
  - /home：用户目录
  - /root：管理员目录
  - /lib：共享库
  - /etc：配置文件和子目录
  - /usr：应用程序
    - /usr/local：软件安装目录（一般是通过编译源码方式安装的程序）
  - /boot：启动文件
  - /dev：硬件设备管理
  - /media：外设挂载目录
  - /mnt：外部存储挂载
  - /proc：[不能动]内存映射
  - /srv：[不能动]服务启动之后需要提取的数据
  - /sys：[不能动]sysfs文件系统
  - /lost+found[隐藏]：系统非正常关机时的缓存
  - /tmp：临时文件
  - /opt：额外安装软件存放目录
  - /var：存放不断扩充的目录（如日志文件）
  - /selinux：[自由启动]安全子系统
## 操作篇
### 远程访问
- 远程登录xshell
  - [下载](https://www.netsarang.com/en/free-for-home-school/)free-for-home-shool版本
  - 检查网络
    - 查看服务端ip地址```ifconfig```
    - 客户端尝试连通服务端```ping ip地址```
    - 在xshell新建会话：主机填ip地址、端口22；双击会话，选择是否保存密码；输入用户名和密码后登录；登录后即可使用命令操作服务器
- 远程传输xftp
  - 在xftp新建会话：主机填ip地址、端口22；双击会话，选择是否保存密码；输入用户名和密码后登录
  - 界面左边是本机，界面右边是远程机； 若远程机显示乱码，则在软件左上角文件→当前会话属性→选项→编码→选择utf-8；即可对文件进行相互传输、修改等操作
### Vi和Vim编辑器
- vi三种模式：
  - 默认模式：输入esc退出当前模式进入默认模式，上下左右移动光标、删除字符、删除整行、复制粘贴操作数据
    - `yy`拷贝当前行；`5yy`拷贝当前行向下5行；`p`粘贴
    - `dd`删除当前行；`5dd`删除当前行向下5行
    - `gg`跳转首行；`G`跳转到末行
    - `u`撤销
    - `行号shift+G`跳转某行
  - 插入模式：默认模式中输入i、o、a、r大小写均可进入编辑
  - 命令行模式：默认模式中输入冒号:或斜杠/进入命令行模式；提供相关指令，完成读取、存盘、替换、离开vim、显示行号等的动作
    - `:wq`(保存并对退出);`:q`(退出);`:q!`(强制退出,不保存)
    - 查询单词`/单词,回车查询,输入n查找下一个`
    - `:set nu`显示行号；`:set nonu`隐藏行号
### 开机、重启、用户登录注销
- 关机和重启
  - `shutdown -h now`：立刻关机
  - `shutdown -h 1`：1分钟后关机
  - `shutdown -r now`：重启
  - `halt`：关机
  - `reboot`：重启
  - `sync`：把内存数据同步到磁盘（建议每次优先执行）
- 登录和注销
  - 登录时尽量少用root帐号登录，普通用户使用`su - root`切换成系统管理员身份
  - 在提示符下输入`logout`即可注销账户（图形界面无效）
### 用户管理
- 添加用户
  - `useradd 用户名`即可添加用户名；`useradd -d 目录 用户名`即可在指定目录创建家目录
  - 新用户默认在/home/用户名/下创建家目录
  - `passwd 用户名`修改用户密码
- 删除用户
  - `userdel 用户名`删除用户并保留家目录；`userdel -r 用户名`删除用户并删除家目录
- 查询用户信息
  - `id 用户名`查询用户信息(用户id，组id，所在组)
  - `su - 用户名`即可切换用户，切换到root不需要用户名；切换到权限更低的用户不需要密码，反之需要；切换回原来用户使用exit或logout命令
  - `whoami`或`who am I`查询登录到机器的当前用户
- 用户组
  - `groupadd 组名`新增组
  - `groupdel 组名`删除组
  - `useradd -g 用户组 用户名`创建用户时加入指定用户组
  - `usermod -g 用户组 用户名`修改用户的组
- 用户相关文件
  - /etc/passwd 文件存储所有用户的信息，其中每行显示:`用户名:口令:用户标识号:组标识号:注释性说明:主目录:登录Shell`
  - /etc/shadow 是口令配置文件：`登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志`
  - /etc/group 文件存储组的配置文件:`组名:口令:组标识号:组内用户列表`
### 实用指令
- 运行级别
  - 常用运行级别（3和5常用）：
    0.关机
    1.单用户(找回丢失密码)
    2.多用户状态，没有网络服务
    3.多用户状态，有网络服务
    4.系统未使用保留给用户
    5.图形界面
    6.系统重启
  - `init 数字`切换到相应运行级别
  - 查看运行级别:`systemctl get-default`
  - 设置默认运行级别：`systemctl set-default 运行级别.target`
    - 多用户有网络状态：`systemctl set-default multi-user.target`
    - 图形界面状态：`systemctl set-default graphical.target`
- 找回root密码
  - centos7.6
    1. 启动系统开机界面按下[e]，移动光标到`linux16开头，UTF-8结尾的行`，输入[ init=/bin/sh]后按Ctrl+x进入单用户模式
    2. 在光标闪烁的位置输入`mount -o remount,rw /`后回车
    3. 在新行输入`passwd`后回车，输入新密码和确认密码
    4. 在光标位置输入`touch /.autorelabel`后回车
    5. 输入`exec /sbin/init`回车，等待后系统自动重启，完成
- 帮助指令
 - man
   - 语法：`man [命令或配置文件]`，获得帮助信息
 - help
   - 语法：`help 命令`，获得shell内置命令的帮助信息
- 文件目录操作
  - `pwd`：显示当前工作目录的绝对路径
  - `ls [选项] [目录或文件]`：默认查看当前目录信息
  - `cd [目录]`切换到指定目录，默认切换到home目录，..表示上一级目录
  - `mkdir [选项]`：创建目录，-p创建多级目录
  - `rmdir [选项]`：删除空目录，`rm -rf [目录]`删除非空目录
  - `touch [目录]`：创建空文件
  - `cp [选项] [文件] [目录]`：将文件拷贝到指定目录，-r递归复制整个文件夹，`\cp -r [文件] [目录]`拷贝并强制覆盖
  - `mv [oldFile] [newFile]`：移动文件目录或重命名
  - `cat [选项] [fileName]`：查看文件内容，-n显示行号;一般会带上管道命令` | more`
  - `more [fileName]`：按页显示文本内容
    - `Space`：翻页
    - `Enter`：下一行
    - `q`：立刻离开
    - `Ctrl+F`：向下一屏
    - `Ctrl+B`：向上一屏
    - `=`：输出当前行号
    - `:f`：输出文件名和当前行号
  - `less [fileName]`：分屏查看文件内容
    - `[Space]`、`[pagedown]`：翻页
    - `[pageup]`:上翻
    - `/字串`：向下搜寻字串，`n`向下查找，`N`向上查找
    - `?字串`：向上搜寻字串的功能，`n`向下查找，`N`向上查找
    - `q`：立刻z离开
  - `echo [选项] [输出内容]`：输出内容到控制台
  - `head [fileName]`：显示文件开头部分，默认前10行；`head -n [num] [fileName]`：通过-n和数字查看任意行数
  - `tail [fileName]`：显示文件结尾部分，默认后10行；`tail -n [num] [fileName]`：通过-n和数字查看任意行数；`tail -f [fileName]`：实时追踪文件更新
  - `>`重定向，`>>`追加
    - `ls -l > [fileName]`：将输出内容写入文件中（没有文件自动创建）
    - `ls -l >> [fileName]`：将输出内容追加到文件末尾
    - `cat [file1] > [file2]`：将文件1的内容覆盖到文件2
    - `echo "str" > [fileName]`：将内容追加到文件末尾
  - `ln -s [源文件或目录] [软链接名或目录]`：给文件创建软链接（类似快捷方式）
  - `history`：查看已执行过的历史命令，`history [num]`：查看指定数量使用过的命令历史，`![num]`：执行数字为历史编号的指令
### 定时任务调度
### 磁盘分区、挂载
### 进程管理
### RPM和YUM
### 网络配置


